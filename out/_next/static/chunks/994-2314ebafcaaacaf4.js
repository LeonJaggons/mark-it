"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[994],{4994:function(e,t,i){i.d(t,{u:function(){return M}});var s=i(5893);i(5922);var n=i(6725),a=i(8618),l=i(3990),o=i(5281),r=i(8783),c=i(7747),u=i(5460),d=i(9993),h=i(6948),g=i(4292),m=i(2757),f=i(8371),x=i(1293),p=i(4225),j=i(5541),w=i(9778),b=i(5294),D=i(4346),I=i(7169),v=i(7294),y=i(5434),S=i(381),z=i.n(S),k=i(1664),C=i.n(k),Z=i(6121),X=i(9473),E=i(7877);let M=e=>{let[t,i]=(0,v.useState)(!1),[j,w]=(0,v.useState)(0),[b]=(0,a.a)("(max-width: 1100px)"),D=(0,X.v9)(e=>e.account.loggedIn),I=(0,X.v9)(e=>e.account.user);return(0,s.jsx)(l.Z,{flex:1,overflow:"hidden",w:"full",h:"full",children:(0,s.jsxs)(o.K,{direction:b?"column":"row",flex:2,height:"100%",children:[(0,s.jsxs)(r.g,{flex:3,height:"100%",w:"full",align:"flex-start",position:"relative",children:[(0,s.jsx)(c.xu,{flexGrow:1,position:"relative",children:(0,s.jsx)(u.E,{src:e.item.images[j],objectFit:"cover",w:"full",height:"full"})}),!e.isPreview&&(0,s.jsx)(d.h,{as:C(),href:"/","aria-label":"Back to browse",icon:(0,s.jsx)(h.J,{as:y.KYK}),position:"absolute",top:2,left:2}),(0,s.jsx)(g.U,{position:"absolute",bottom:2,alignSelf:"center",overflowX:"scroll",padding:2,backgroundColor:"blackAlpha.600",borderRadius:5,children:e.item.images.map((e,t)=>(0,s.jsx)(u.E,{filter:t===j&&"brightness(90%)",borderWidth:t===j&&2,borderColor:"messenger.600",borderStyle:"solid",borderRadius:5,src:e,cursor:"pointer",height:"55px",aspectRatio:1,objectFit:"cover",onClick:()=>w(t)}))})]}),(0,s.jsx)(c.xu,{flex:2,padding:4,height:"100%",children:(0,s.jsxs)(r.g,{align:"flex-start",spacing:1,height:"100%",children:[(0,s.jsx)(m.X,{size:"lg",children:e.item.title?e.item.title:"Title"}),(0,s.jsx)(m.X,{size:"md",fontWeight:700,my:1,children:e.item.price?"$".concat(e.item.price):"Price"}),(0,s.jsxs)(m.X,{size:"xs",fontWeight:400,color:"blackAlpha.800",mb:2,children:["Posted ",z()().format("MMMM D, YYYY")]}),e.item.category&&(0,s.jsxs)(f.Vp,{p:2,variant:"outline",children:[(0,s.jsx)(h.J,{as:y.VzJ,mr:2}),(0,s.jsx)(m.X,{size:"xs",fontWeight:600,color:"blackAlpha.800",children:e.item.category})]}),(0,s.jsxs)(g.U,{my:4,w:"full",children:[D&&I.userID!==e.item.userID&&(0,s.jsx)(J,{itemID:e.item.itemID}),(0,s.jsx)(K,{}),(0,s.jsx)(P,{})]}),(0,s.jsx)(m.X,{size:"sm",children:"Description"}),(0,s.jsx)(x.x,{fontSize:14,children:e.item.description}),(0,s.jsx)(m.X,{size:"sm",mt:4,children:"Location"}),e.item.location&&(0,s.jsx)("div",{style:{height:180,width:"100%",borderRadius:5,overflow:"hidden"},children:(0,s.jsx)(n.ZP,{defaultCenter:{lat:e.item.location.latitude,lng:e.item.location.longitude},options:{fullscreenControl:!1,zoomControl:!1,panControl:!1,gestureHandling:"none"},zoom:15})}),(0,s.jsx)(c.xu,{flex:1}),I&&I.userID!==e.item.userID&&(0,s.jsxs)(r.g,{w:"full",children:[(0,s.jsx)(p.z,{w:"full",colorScheme:"messenger",isDisabled:e.isPreview,children:"Make an Offer"}),(0,s.jsx)(p.z,{w:"full",isDisabled:e.isPreview,onClick:()=>i(!0),children:"Message Seller"}),(0,s.jsx)(Y,{visible:t,item:e.item,close:()=>i(!1)})]})]})})]})})},Y=e=>{let[t,i]=(0,v.useState)(""),[n,a]=(0,v.useState)(!1),l=async()=>{a(!0);let i=e.item.userID,s=e.item.itemID;await (0,E.bG)(i,s,t),a(!1),e.close()};return(0,v.useEffect)(()=>{console.log(e.item)},[]),(0,s.jsxs)(j.u_,{isOpen:e.visible,onClose:e.close,isCentered:!0,children:[(0,s.jsx)(w.Z,{}),(0,s.jsx)(b.h,{children:(0,s.jsxs)(D.f,{p:0,children:[(0,s.jsx)(g.U,{p:4,borderBottom:"1px solid rgba(0,0,0,.05)",align:"center",children:(0,s.jsx)(m.X,{size:"md",children:"Message"})}),(0,s.jsxs)(r.g,{w:"full",align:"flex-start",p:4,children:[(0,s.jsxs)(g.U,{mb:6,children:[(0,s.jsx)(u.E,{borderRadius:5,src:e.item.images[0],w:"60px",objectFit:"cover",aspectRatio:1}),(0,s.jsxs)(r.g,{align:"flex-start",children:[(0,s.jsx)(m.X,{size:"sm",children:e.item.title}),(0,s.jsxs)(m.X,{size:"xs",fontWeight:400,children:["$",e.item.price]})]})]}),(0,s.jsx)(I.g,{value:t,onChange:e=>{i(e.target.value)},placeholder:"Type your message..."})]}),(0,s.jsxs)(g.U,{p:4,borderTop:"1px solid rgba(0,0,0,.05)",align:"center",justify:"flex-end",children:[(0,s.jsx)(p.z,{flex:1,children:"Cancel"}),(0,s.jsx)(p.z,{onClick:l,isDisabled:!t||""===t.trim(),isLoading:n,flex:1,colorScheme:"messenger",rightIcon:(0,s.jsx)(h.J,{as:y.D6S}),children:"Send message"})]})]})})]})},J=e=>{let[t,i]=v.useState<boolean|!1,n=(0,X.v9)(e=>e.account.loggedIn),a=async()=>{let t=await (0,Z.zo)(e.itemID);i(t)};(0,v.useEffect)(()=>{n&&a()},[e.itemID,n]);let l=async()=>{i(!0),await (0,Z.YI)(e.itemID)},o=async()=>{i(!1),await (0,Z.$6)(e.itemID)};return(0,s.jsx)(R,{onClick:()=>{null==t?l():t?o():l()},icon:t?y.Wm3:y.ThK,active:t,children:"Like"})},K=()=>(0,s.jsx)(R,{icon:y.KQY,children:"Share"}),P=()=>(0,s.jsx)(R,{icon:y.xr$,fit:!0}),R=e=>(0,s.jsx)(p.z,{variant:"solid",onClick:e.onClick,leftIcon:(0,s.jsx)(h.J,{as:e.icon}),colorScheme:e.active?"messenger":"gray",flex:e.fit?0:1,size:"md",children:e.children})},6121:function(e,t,i){i.d(t,{$6:function(){return m},D3:function(){return d},HA:function(){return u},Nx:function(){return c},YI:function(){return g},lx:function(){return r},zo:function(){return h}});var s=i(4447);i(5922);var n=i(8216),a=i(6154),l=i(6100),o=i(6650);let r=async()=>{let e=n.h.getState().item.postItem,t={...e};n.h.getState().account.user;let i=t.images;for(let e of(delete t.images,console.log(t),Object.keys(t)))void 0===t[e]&&delete t[e];let a=(0,l.hJ)(s.DU,"item"),r=await (0,l.ET)(a,t).catch(e=>console.log(e));if(r){let e=r.id,t=[];if(i){let n=0;for(let a of i){n++;let i=(0,o.iH)(s.hr,"item/".concat(e,"/imgs/img-").concat(n,".jpg")),l=await fetch(a).catch(e=>console.log(e)),r=await l.blob(),c=await (0,o.KV)(i,r).catch(e=>console.log(e));if(c){let e=await (0,o.Jt)(c.ref);t.push(e)}}}await (0,l.r7)(r,{itemID:r.id,images:t})}},c=async()=>{let e=await a.Z.get("/api/item"),t=e.data;return t},u=async e=>{let t=await a.Z.get("/api/item?id=".concat(e));return t.data},d=async()=>{let e=n.h.getState().account.user.userID,t=await a.Z.get("api/favorite?userID=".concat(e));return t.data},h=async e=>{let t=await d();return null==t?void 0:t.map(e=>e.itemID).includes(e)},g=async e=>{let t=n.h.getState().account.user.userID;await a.Z.post("/api/favorite?itemID=".concat(e,"&userID=").concat(t))},m=async e=>{let t=n.h.getState().account.user.userID;await a.Z.delete("/api/favorite?itemID=".concat(e,"&userID=").concat(t))}},7877:function(e,t,i){i.d(t,{bG:function(){return r},di:function(){return a},rr:function(){return l}});var s=i(8216),n=i(6154);let a=async()=>{let e=await o(),t=[];for(let i of e)if(0===t.length)t.push(i);else{let e=!1;for(let s of t)if(s.itemID==i.itemID&&s.participants.includes(i.to)&&s.participants.includes(i.from)){e=!0;break}e||t.push(i)}return console.log(t),t},l=async()=>{let{to:e,from:t,itemID:i}=s.h.getState().item.focusedMessage,a=await n.Z.get("/api/message?to=".concat(e,"&from=").concat(t,"&itemID=").concat(i));return console.log(a.data),a.data},o=async()=>{let e=s.h.getState().account.user.userID;console.log(e);let t=await n.Z.get("/api/message?userID=".concat(e));return console.log(t.data),t.data},r=async(e,t,i)=>{let a=s.h.getState().account.user.userID,l=await n.Z.post("/api/message?to=".concat(e,"&from=").concat(a,"&content=").concat(i,"&itemID=").concat(t));return l.data}}}]);